import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import json

# Create comprehensive supplier dataset with mock data for missing fields
suppliers_data = [
    {
        "name": "Fabrika Demo Sanayi ve Ticaret Anonim Sirketi",
        "category": "RAW MATERIAL - Polymer Synthesis",
        "subcategory": "TRANSFORMATION - Spinning, RAW MATERIAL - Mechanical Recycling",
        "certification_score": 0,
        "address": "Unknown",
        "postal_code": "",
        "city": "Istanbul",
        "country": "TR",
        "certifications": "GRS, ZDHC",
        "employees": 0,
        "production_capacity": "Unknown",
        "last_audit_date": "2024-09-15",
        "audit_status": "Pending",
        "next_audit_date": "2026-03-15",
        "grs_expiry": "2025-08-20",
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Medium",
        "environmental_risk": "Medium",
        "compliance_risk": "Medium",
    },
    {
        "name": "Confection Soleil (Démo)",
        "category": "MANUFACTURING - Ready To Wear",
        "subcategory": "",
        "certification_score": 0,
        "address": "10 rue de la justice",
        "postal_code": "",
        "city": "Bezier",
        "country": "FR",
        "certifications": "WRAP GOLD, GOTS",
        "employees": 45,
        "production_capacity": "30000 PIECES/MONTH",
        "last_audit_date": "2024-11-10",
        "audit_status": "Passed",
        "next_audit_date": "2025-11-10",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": "2025-06-15",
        "rwas_expiry": None,
        "wrap_expiry": "2026-02-28",
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Paolo tessitura",
        "category": "TRANSFORMATION - Weaving",
        "subcategory": "",
        "certification_score": 0,
        "address": "Via dell'Industria",
        "postal_code": "",
        "city": "Roma",
        "country": "IT",
        "certifications": "GOTS, GRS",
        "employees": 38,
        "production_capacity": "25000 KG/MONTH",
        "last_audit_date": "2024-08-22",
        "audit_status": "Passed",
        "next_audit_date": "2025-08-22",
        "grs_expiry": "2025-11-10",
        "zdhc_expiry": None,
        "gots_expiry": "2025-08-23",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Suzhou Spinning & Dyeing Textile Co. ,Ltd.",
        "category": "TRANSFORMATION - Spinning",
        "subcategory": "TRANSFORMATION - Dyeing",
        "certification_score": 0,
        "address": "298 Xinglong St, 298",
        "postal_code": "",
        "city": "Suzhou",
        "country": "CN",
        "certifications": "GOTS, GRS",
        "employees": 300,
        "production_capacity": "200000 KG/MONTH",
        "last_audit_date": "2024-07-10",
        "audit_status": "Passed",
        "next_audit_date": "2025-07-10",
        "grs_expiry": "2025-09-15",
        "zdhc_expiry": None,
        "gots_expiry": "2025-07-20",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": True,
        "incident_type": "Environmental concern",
        "geopolitical_risk": "High",
        "environmental_risk": "High",
        "compliance_risk": "Medium",
    },
    {
        "name": "Scandicci - Trims & Buttons Srl",
        "category": "MANUFACTURING - Other",
        "subcategory": "TRANSFORMATION - Metal Shaping, TRANSFORMATION - Plastic Shaping",
        "certification_score": 0,
        "address": "Via San Colombano, 187/a",
        "postal_code": "",
        "city": "Scandicci",
        "country": "IT",
        "certifications": "WRAP GOLD, ZDHC",
        "employees": 80,
        "production_capacity": "50000 PIECES/WEEK",
        "last_audit_date": "2024-10-05",
        "audit_status": "Passed",
        "next_audit_date": "2025-10-05",
        "grs_expiry": None,
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": "2026-05-10",
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Gilmore Merino Animal Farm",
        "category": "RAW MATERIAL - Breeding",
        "subcategory": "",
        "certification_score": 0,
        "address": "6 Killarney Road",
        "postal_code": "",
        "city": "Gilmore",
        "country": "AU",
        "certifications": "RWS",
        "employees": 20,
        "production_capacity": "5000 KG/MONTH",
        "last_audit_date": "2024-06-12",
        "audit_status": "Passed",
        "next_audit_date": "2025-06-12",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": None,
        "rwas_expiry": "2025-05-24",
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Curvino SPA (Démo)",
        "category": "TRANSFORMATION - Knitting",
        "subcategory": "TRANSFORMATION - Dyeing, TRANSFORMATION - Chemical Treatment",
        "certification_score": 0,
        "address": "via delle volte",
        "postal_code": "",
        "city": "Ferrara",
        "country": "IT",
        "certifications": "GOTS, GRS",
        "employees": 200,
        "production_capacity": "100000 KG/MONTH",
        "last_audit_date": "2024-09-30",
        "audit_status": "Passed",
        "next_audit_date": "2025-09-30",
        "grs_expiry": "2025-10-15",
        "zdhc_expiry": None,
        "gots_expiry": "2025-09-25",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "INDUSTRIAL FOAM PLASTIC CO.LTD",
        "category": "TRANSFORMATION - Plastic Shaping",
        "subcategory": "",
        "certification_score": 0,
        "address": "Unknown",
        "postal_code": "",
        "city": "Taipei",
        "country": "TW",
        "certifications": "GRS, ZDHC",
        "employees": 250,
        "production_capacity": "300000 KG/MONTH",
        "last_audit_date": "2024-08-15",
        "audit_status": "Failed",
        "next_audit_date": "2025-02-15",
        "grs_expiry": "2025-12-20",
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": True,
        "incident_type": "Quality deviation",
        "geopolitical_risk": "Medium",
        "environmental_risk": "High",
        "compliance_risk": "High",
    },
    {
        "name": "Luan Fung Leather Company",
        "category": "RAW MATERIAL - Tanning",
        "subcategory": "TRANSFORMATION - Chemical Treatment",
        "certification_score": 0,
        "address": "Zhong Luo Tan Town Industrial Estate",
        "postal_code": "",
        "city": "Guangzhou",
        "country": "CN",
        "certifications": "ZDHC",
        "employees": 150,
        "production_capacity": "50000 PIECES/MONTH",
        "last_audit_date": "2024-10-20",
        "audit_status": "Passed",
        "next_audit_date": "2025-10-20",
        "grs_expiry": None,
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "High",
        "environmental_risk": "High",
        "compliance_risk": "Medium",
    },
    {
        "name": "Rada yarn (Démo)",
        "category": "TRANSFORMATION - Spinning",
        "subcategory": "RAW MATERIAL - Polymer Synthesis",
        "certification_score": 0,
        "address": "Unknown",
        "postal_code": "",
        "city": "Burgas",
        "country": "BG",
        "certifications": "GRS",
        "employees": 70,
        "production_capacity": "80000 KG/MONTH",
        "last_audit_date": "2024-09-01",
        "audit_status": "Passed",
        "next_audit_date": "2025-09-01",
        "grs_expiry": "2025-11-15",
        "zdhc_expiry": None,
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Medium",
        "environmental_risk": "Medium",
        "compliance_risk": "Low",
    },
    {
        "name": "GERHY Vulcanization co",
        "category": "TRANSFORMATION - Sole Vulcanisation",
        "subcategory": "",
        "certification_score": 0,
        "address": "Unknown",
        "postal_code": "",
        "city": "Yogyakarta",
        "country": "IN",
        "certifications": "ZDHC",
        "employees": 40,
        "production_capacity": "50000 PIECES/MONTH",
        "last_audit_date": "2024-05-10",
        "audit_status": "Pending",
        "next_audit_date": "2025-05-10",
        "grs_expiry": None,
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": True,
        "incident_type": "Labor concern",
        "geopolitical_risk": "Medium",
        "environmental_risk": "Medium",
        "compliance_risk": "Medium",
    },
    {
        "name": "Ranzi Non Woven Sanayi Ve Ticaret Anonim Sirketi",
        "category": "TRANSFORMATION - Non Woven Processing",
        "subcategory": "",
        "certification_score": 0.65,
        "address": "Unknown",
        "postal_code": "",
        "city": "Ankara",
        "country": "TR",
        "certifications": "GRS, ZDHC",
        "employees": 0,
        "production_capacity": "Unknown",
        "last_audit_date": "2024-11-03",
        "audit_status": "Passed",
        "next_audit_date": "2025-11-03",
        "grs_expiry": "2025-10-20",
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Medium",
        "environmental_risk": "Medium",
        "compliance_risk": "Low",
    },
    {
        "name": "Dongguan Knitting Garment Ltd.",
        "category": "TRANSFORMATION - Knitting",
        "subcategory": "",
        "certification_score": 0.81,
        "address": "145 Fu Kang Lu",
        "postal_code": "",
        "city": "Chongqing",
        "country": "CN",
        "certifications": "GOTS",
        "employees": 700,
        "production_capacity": "750000 PIECES/MONTH",
        "last_audit_date": "2024-10-18",
        "audit_status": "Passed",
        "next_audit_date": "2025-10-18",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": "2025-09-20",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "High",
        "environmental_risk": "High",
        "compliance_risk": "Medium",
    },
    {
        "name": "Lavandaria da Rosa, Ltd.",
        "category": "TRANSFORMATION - Laundry",
        "subcategory": "",
        "certification_score": 0.81,
        "address": "via bosco di capodimonte",
        "postal_code": "",
        "city": "Naples",
        "country": "IT",
        "certifications": "ZDHC",
        "employees": 40,
        "production_capacity": "20000 PIECES/WEEK",
        "last_audit_date": "2024-09-25",
        "audit_status": "Passed",
        "next_audit_date": "2025-09-25",
        "grs_expiry": None,
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Filatura Famiglia S.p.a",
        "category": "TRANSFORMATION - Spinning",
        "subcategory": "TRANSFORMATION - Dyeing",
        "certification_score": 0.81,
        "address": "Via della Prosperità",
        "postal_code": "",
        "city": "Milan",
        "country": "IT",
        "certifications": "GOTS",
        "employees": 67,
        "production_capacity": "80000 KG/MONTH",
        "last_audit_date": "2024-11-12",
        "audit_status": "Passed",
        "next_audit_date": "2025-11-12",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": "2025-08-23",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Maglificio dell'ulivo",
        "category": "TRANSFORMATION - Knitting",
        "subcategory": "",
        "certification_score": 0.81,
        "address": "Via di Spedaletto, 1A",
        "postal_code": "",
        "city": "Pistoia",
        "country": "IT",
        "certifications": "GRS",
        "employees": 55,
        "production_capacity": "15000 PIECES/MONTH",
        "last_audit_date": "2024-08-08",
        "audit_status": "Passed",
        "next_audit_date": "2025-08-08",
        "grs_expiry": "2025-11-10",
        "zdhc_expiry": None,
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Thrace Cotton Cooperative",
        "category": "RAW MATERIAL - Harvesting",
        "subcategory": "",
        "certification_score": 0.81,
        "address": "3ou Sintagmatos 11",
        "postal_code": "",
        "city": "Feres",
        "country": "GR",
        "certifications": "GOTS",
        "employees": 220,
        "production_capacity": "50000 KG/YEAR",
        "last_audit_date": "2024-07-14",
        "audit_status": "Passed",
        "next_audit_date": "2025-07-14",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": "2025-08-23",
        "rwas_expiry": None,
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Medium",
        "compliance_risk": "Low",
    },
    {
        "name": "Eneas Ginning",
        "category": "RAW MATERIAL - Preparation",
        "subcategory": "",
        "certification_score": 0.81,
        "address": "27 El. Venizelou Str.",
        "postal_code": "",
        "city": "Kavala",
        "country": "GR",
        "certifications": "GOTS, RWS",
        "employees": 70,
        "production_capacity": "100000 KG/MONTH",
        "last_audit_date": "2024-10-30",
        "audit_status": "Passed",
        "next_audit_date": "2025-10-30",
        "grs_expiry": None,
        "zdhc_expiry": None,
        "gots_expiry": "2025-08-23",
        "rwas_expiry": "2025-05-24",
        "wrap_expiry": None,
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "Confecções Tomás, Lda.",
        "category": "MANUFACTURING - Ready To Wear",
        "subcategory": "",
        "certification_score": 1,
        "address": "R. de São Saturnino 1223",
        "postal_code": "",
        "city": "Lordelo",
        "country": "PT",
        "certifications": "WRAP GOLD, ZDHC",
        "employees": 150,
        "production_capacity": "50000 PIECES/MONTH",
        "last_audit_date": "2024-11-20",
        "audit_status": "Passed",
        "next_audit_date": "2025-11-20",
        "grs_expiry": None,
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": "2026-02-28",
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Low",
        "environmental_risk": "Low",
        "compliance_risk": "Low",
    },
    {
        "name": "João Fábrica de Calçado, Ltd.",
        "category": "MANUFACTURING - Shoe",
        "subcategory": "RAW MATERIAL - Tanning",
        "certification_score": 1,
        "address": "Avenida Principal 5895",
        "postal_code": "49100-000",
        "city": "São Cristóvão",
        "country": "BR",
        "certifications": "WRAP GOLD, ZDHC, GRS",
        "employees": 100,
        "production_capacity": "10000000 PAIRS/YEAR",
        "last_audit_date": "2024-10-12",
        "audit_status": "Passed",
        "next_audit_date": "2025-10-12",
        "grs_expiry": "2025-12-15",
        "zdhc_expiry": "2026-01-22",
        "gots_expiry": None,
        "rwas_expiry": None,
        "wrap_expiry": "2026-02-28",
        "has_incidents": False,
        "incident_type": None,
        "geopolitical_risk": "Medium",
        "environmental_risk": "Medium",
        "compliance_risk": "Low",
    }
]

# Create DataFrame
df = pd.DataFrame(suppliers_data)

# Save to CSV for use in Streamlit app
df.to_csv('suppliers_full_data.csv', index=False)
print("Data prepared successfully!")
print(f"\nDataset contains {len(df)} suppliers with {len(df.columns)} fields")
print("\nColumns:", df.columns.tolist())
print("\nSample data (first 3 suppliers):")
print(df[['name', 'city', 'country', 'certifications', 'audit_status']].head(3))